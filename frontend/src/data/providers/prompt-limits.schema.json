{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "$id": "prompt-limits.schema.json",
  "title": "PromptLimitsConfig",
  "description": "Schema for AI image platform prompt length limits and optimization data",
  "type": "object",
  "required": ["$schema", "version", "lastUpdated", "providers"],
  "additionalProperties": false,
  "properties": {
    "$schema": {
      "type": "string",
      "description": "JSON Schema reference"
    },
    "version": {
      "type": "string",
      "pattern": "^\\d+\\.\\d+\\.\\d+$",
      "description": "Semantic version of the config"
    },
    "lastUpdated": {
      "type": "string",
      "pattern": "^\\d{4}-\\d{2}-\\d{2}$",
      "description": "ISO date of last update"
    },
    "meta": {
      "type": "object",
      "properties": {
        "description": { "type": "string" },
        "authorityDoc": { "type": "string" },
        "researchNotes": { "type": "string" }
      }
    },
    "providers": {
      "type": "object",
      "additionalProperties": {
        "$ref": "#/definitions/PromptLimit"
      },
      "minProperties": 1,
      "description": "Map of provider ID to prompt limits"
    }
  },
  "definitions": {
    "PromptLimit": {
      "type": "object",
      "required": [
        "maxChars",
        "idealMin",
        "idealMax",
        "idealWords",
        "platformNote",
        "optimizationBenefit",
        "qualityImpact",
        "impactCategory",
        "architecture",
        "sources"
      ],
      "additionalProperties": false,
      "properties": {
        "maxChars": {
          "type": ["integer", "null"],
          "minimum": 1,
          "description": "Maximum character limit (null if unlimited)"
        },
        "idealMin": {
          "type": "integer",
          "minimum": 1,
          "description": "Lower bound of optimal range"
        },
        "idealMax": {
          "type": "integer",
          "minimum": 1,
          "description": "Upper bound of optimal range"
        },
        "idealWords": {
          "type": "integer",
          "minimum": 1,
          "description": "Approximate optimal word count"
        },
        "tokenLimit": {
          "type": ["integer", "null"],
          "minimum": 1,
          "description": "CLIP/encoder token limit if applicable"
        },
        "platformNote": {
          "type": "string",
          "minLength": 1,
          "description": "Platform-specific behavior insight"
        },
        "optimizationBenefit": {
          "type": "string",
          "minLength": 1,
          "description": "What optimization achieves"
        },
        "qualityImpact": {
          "type": "string",
          "pattern": "^\\d+-\\d+%$",
          "description": "Expected improvement range (e.g., '5-10%')"
        },
        "impactCategory": {
          "type": "string",
          "enum": ["high", "moderate", "low"],
          "description": "Impact severity for prioritization"
        },
        "architecture": {
          "type": "string",
          "enum": ["clip-based", "transformer", "proprietary", "unknown"],
          "description": "Model architecture type"
        },
        "sources": {
          "type": "array",
          "items": { "type": "string", "minLength": 1 },
          "minItems": 1,
          "description": "Research provenance for auditability"
        }
      }
    }
  }
}
