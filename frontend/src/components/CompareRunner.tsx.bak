import { useEffect, useState } from "react";
import { ALL_PROVIDERS } from "@/lib/providers";

export default function CompareRunner({ showAll=false }:{ showAll?: boolean }) {
  const [prefs, setPrefs] = useState<string[] | null>(null);
  useEffect(() => {
    fetch("/api/user/me/preferences", { credentials:"include" })
      .then(r => r.json()).then(d => setPrefs(d?.preferredProviders ?? []));
  }, []);
  if (prefs === null) return null;

  const providers = showAll || prefs.length === 0
    ? ALL_PROVIDERS
    : ALL_PROVIDERS.filter(p => prefs.includes(p.id));

  return (
    <div>
      {/* toggle in page chrome */}
      {/* <Switch label="Show all providers" .../> */}
      {providers.map(p => (
        <button key={p.id} onClick={()=> runCompareWith(p.id)}>
          Run with {p.displayName}
        </button>
      ))}
    </div>
  );
}

function runCompareWith(providerId: string) {
  // call your backend with the canonical request + providerId
}
